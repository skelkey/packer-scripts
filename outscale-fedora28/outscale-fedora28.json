{
  "variables": {
      "aws_profile": ""
  },
  "builders": [{
    "name": "Europe - Outscale",
    "type": "osc-ebssurrogate",
    "profile": "{{user `aws_profile`}}",

    "ssh_username": "outscale",
    "ssh_interface": "public_ip",
    "ami_name": "Fedora Cloud 28 - {{isotime \"02-01-2006\"}}",

    "instance_type": "t2.large",
    "region": "eu-west-2",
    "launch_block_device_mappings": [{
        "volume_type": "standard",
        "device_name": "/dev/xvdf",
        "delete_on_termination": true,
        "volume_size": 10
    }],
    "ami_root_device": {
                "delete_on_termination": true,
                "source_device_name": "/dev/xvdf",
                "device_name": "/dev/sda1",
                "volume_size": 10,
                "volume_type": "standard"
    },
    "ami_virtualization_type": "hvm",
    "availability_zone": "eu-west-2a",
    "endpoints": {"ec2": "https://fcu.eu-west-2.outscale.com"},
    "run_tags": {
      "Name": "Packer Builder - Fedora Cloud 28"
    },
    "source_ami_filter": {
        "filters": {
            "name": "CentOS-7*",
            "owner-alias": "Outscale"
        }
    }
  }],
  "provisioners": [{
    "type": "shell",
    "inline": [
      "sudo yum install -y wget",
      "wget https://fr2.rpmfind.net/linux/fedora/linux/releases/28/Cloud/x86_64/images/Fedora-Cloud-Base-28-1.1.x86_64.raw.xz",
      "sudo sh -c 'xz -d <  Fedora-Cloud-Base-28-1.1.x86_64.raw.xz - | dd bs=8M status=progress of=/dev/xvdf'"
    ]
  }]
}
